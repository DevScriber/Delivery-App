(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const D=e=>{const o=document.querySelector(e);o&&o.classList.toggle("is-hidden")},w={"dashboard-add-client":".add-client-modal","dashboard-search-client":".search-client-modal","dashboard-clients-list":".clients-list-modal","dashboard-map":".map-modal"};document.querySelector(".nav-buttons").addEventListener("click",e=>{const o=e.target.closest(".dashboard-button");if(o){for(const t of o.classList)if(w[t]){D(w[t]);break}}});document.querySelectorAll(".btn-exit").forEach(e=>{e.addEventListener("click",()=>{const o=e.closest(".backdrop"),t=document.querySelector(".search-client-result"),n=document.querySelector(".data-content");o&&(t.classList.add("is-hidden"),n.innerHTML="",o.classList.add("is-hidden"))})});document.addEventListener("keydown",e=>{e.key==="Escape"&&document.querySelectorAll(".backdrop").forEach(o=>{o.classList.add("is-hidden")})});function S(){return JSON.parse(localStorage.getItem("clientData"))||[]}function I(e){localStorage.setItem("clientData",JSON.stringify(e))}function M(e){const o=S(),t=o.findIndex(n=>n.id===e.id);t!==-1&&(o[t]=e,I(o))}function N(e){const t=S().filter(n=>String(n.id)!==String(e));localStorage.setItem("clientData",JSON.stringify(t))}let L=null;function E(e,o){const t=document.querySelector(".edit-client-modal");if(!t)return;const n=t.querySelector("#edit-id"),r=t.querySelector("#edit-name"),s=t.querySelector("#edit-surname"),a=t.querySelector("#edit-phone"),d=t.querySelector("#country"),u=t.querySelector("#edit-region"),m=t.querySelector("#edit-city"),l=t.querySelector("#edit-address"),c=t.querySelector("#coordinates");!n||!r||!s||!a||!d||!u||!m||!l||!c||(n.value="",r.value="",s.value="",a.value="",d.value="",u.value="",m.value="",l.value="",c.value="",n.value=e.id||"",r.value=e.name||"",s.value=e.surname||"",a.value=e.phone||"",d.value=e.country||"Украина",u.value=e.region||"Винницкая область",m.value=e.city||"",l.value=e.address||"",c.value=e.coordinates||"",L=typeof o=="function"?o:null,t.classList.remove("is-hidden"))}function O(){const e=document.querySelector(".edit-client-form");e&&e.addEventListener("submit",o=>{var r,s,a,d,u,m,l,c,i;o.preventDefault();const t={id:((r=e.querySelector("#edit-id"))==null?void 0:r.value.trim())||"",name:((s=e.querySelector("#edit-name"))==null?void 0:s.value.trim())||"",surname:((a=e.querySelector("#edit-surname"))==null?void 0:a.value.trim())||"",phone:((d=e.querySelector("#edit-phone"))==null?void 0:d.value.trim())||"",country:((u=e.querySelector("#country"))==null?void 0:u.value.trim())||"",region:((m=e.querySelector("#edit-region"))==null?void 0:m.value.trim())||"",city:((l=e.querySelector("#edit-city"))==null?void 0:l.value.trim())||"",address:((c=e.querySelector("#edit-address"))==null?void 0:c.value.trim())||"",coordinates:((i=e.querySelector("#coordinates"))==null?void 0:i.value.trim())||""};M(t);const n=document.querySelector(".edit-client-modal");n&&n.classList.add("is-hidden"),typeof L=="function"&&L(t)})}const C=document.querySelector(".add-coordinates-btn");C&&(C.onclick=()=>{navigator.geolocation.getCurrentPosition(e=>{const o=document.querySelector(".edit-client-modal"),t=o==null?void 0:o.querySelector("#coordinates");t?(t.value=`${e.coords.latitude}, ${e.coords.longitude}`,console.log("Координаты установлены:",t.value)):console.warn("Поле #coordinates не найдено")},e=>{console.error("Ошибка геолокации:",e)})});function _(){const e=document.querySelector(".search-client-modal");if(!e)return;const o=e.querySelector(".dashboard-modal__form"),t=e.querySelector(".search-client-result"),n=e.querySelector(".data-content");o.addEventListener("submit",r=>{r.preventDefault();const s=o.id.value.trim(),a=o.name.value.trim().toLowerCase(),d=o.surname.value.trim().toLowerCase(),u=o.phone.value.trim(),l=S().find(i=>(!s||String(i.id)===s)&&(!a||i.name.toLowerCase().trim()===a)&&(!d||i.surname.toLowerCase().trim()===d)&&(!u||i.phone===u)),c=i=>{n.innerHTML=`
        <p><strong>ID:</strong> ${i.id}</p>
        <p><strong>Имя:</strong> ${i.name}</p>
        <p><strong>Фамилия:</strong> ${i.surname}</p>
        <p><strong>Телефон:</strong> ${i.phone}</p>
        <p><strong>Страна:</strong> ${i.country||""}</p>
        <p><strong>Область:</strong> ${i.region||""}</p>
        <p><strong>Город/Село:</strong> ${i.city||""}</p>
        <p><strong>Адрес:</strong> ${i.address||""}</p>
        <p><strong>Координаты:</strong> ${i.coordinates||""}</p>
      `};if(l){c(l),t.classList.remove("is-hidden");const i=t.querySelector(".change-info"),q=t.querySelector(".cancel"),v=t.querySelector(".map");i&&(i.onclick=()=>{E(l,p=>{Object.assign(l,p),c(p)})}),q&&(q.onclick=()=>{confirm("Удалить этого клиента?")&&(N(l.id),n.innerHTML="<p>Клиент удалён</p>")}),v&&(v.onclick=()=>{var y;const p=(y=l.coordinates)==null?void 0:y.trim();if(!p){alert("У клиента нет координат");return}const[g,f]=p.split(",").map(Number);if(isNaN(g)||isNaN(f)){alert("Неверный формат координат");return}const h=`https://www.google.com/maps?q=${g},${f}`;window.open(h,"_blank")})}else n.innerHTML="<p>Клиент не найден</p>",t.classList.remove("is-hidden");o.reset()})}function B(){const e=document.querySelector(".add-client__form");e&&e.addEventListener("submit",o=>{o.preventDefault();const t={};for(let r of e.elements)r.name&&(t[r.name]=r.value.trim());t.id=Date.now().toString();const n=S();n.push(t),I(n),e.reset()})}function H(){const e=document.querySelector(".dashboard-clients-list"),o=document.querySelector(".clients-list-modal"),t=o==null?void 0:o.querySelector(".clients-list__allClients"),n=document.querySelector(".action-btn-group");!e||!o||!t||!n||e.addEventListener("click",()=>{T(t,n)})}function T(e,o){const t=S();if(e.innerHTML="",t.length===0){e.innerHTML='<li><p class="clients-list__no-clients">Клиенты не найдены.</p></li>';return}t.forEach((n,r)=>{const s=document.createElement("li");s.className="clients-list__client";const a=document.createElement("div");a.className="data-content",a.innerHTML=`
    <p><strong>№</strong> ${r+1}</p>
      <p><strong>ID:</strong> ${n.id}</p>
      <p><strong>Имя:</strong> ${n.name}</p>
      <p><strong>Фамилия:</strong> ${n.surname}</p>
      <p><strong>Телефон:</strong> ${n.phone}</p>
      <p><strong>Страна:</strong> ${n.country}</p>
      <p><strong>Область:</strong> ${n.region||""}</p>
      <p><strong>Город/село:</strong> ${n.city||""}</p>
      <p><strong>Адрес:</strong> ${n.address||""}</p>
      <p><strong>Координаты:</strong> ${n.coordinates}</p>
    `;const d=o.cloneNode(!0),u=d.querySelector(".change-info"),m=d.querySelector(".map"),l=d.querySelector(".cancel");u.onclick=()=>{E(n,c=>{Object.assign(n,c),a.innerHTML=`
          <p><strong>ID:</strong> ${c.id}</p>
          <p><strong>Имя:</strong> ${c.name}</p>
          <p><strong>Фамилия:</strong> ${c.surname}</p>
          <p><strong>Телефон:</strong> ${c.phone}</p>
          <p><strong>Страна:</strong> ${c.country}</p>
          <p></p><strong>Область:</strong> ${c.region||""}</p>
          <p><strong>Город/село:</strong> ${c.city||""}</p>
          <p><strong>Адрес:</strong> ${c.address||""}</p>
          <p><strong>Координаты:</strong> ${c.coordinates}</p>
        `})},m.onclick=()=>{var p,g,f,h,y;const c=(p=n.coordinates)==null?void 0:p.trim();if(c){const[$,b]=c.split(",").map(Number);if(!isNaN($)&&!isNaN(b)){const k=`https://www.google.com/maps?q=${$},${b}`;window.open(k,"_blank");return}}const i=[(g=n.country)==null?void 0:g.trim(),(f=n.region)==null?void 0:f.trim(),(h=n.city)==null?void 0:h.trim(),(y=n.address)==null?void 0:y.trim()].filter(Boolean);if(i.length===0){alert("Нет координат и недостаточно данных для адреса");return}const v=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(i.join(", "))}`;window.open(v,"_blank")},l.onclick=()=>{confirm("Удалить клиента?")&&(N(n.id),s.remove())},s.append(a,d),e.appendChild(s)})}document.addEventListener("DOMContentLoaded",()=>{B(),_(),O(),H()});
//# sourceMappingURL=index.js.map
